branches:
  only:
    - integration
    - /-ci$/
    - /-cit$/

os: linux
dist: trusty

language: c

services:
  - docker

jobs:
  # The first five jobs should be the canaries in the coal mine, i.e. the most likely to fail if there are problems in the code.
  # They should also be a good mix of unit, integration, and documentation tests.
  #
  # In general tests should be ordered from slowest to fastest for the first five jobs (the maximum concurrent jobs allowed), then
  # slowest to fastest for the rest of the tests. This does not make a difference for testing a single commit, but when multiple
  # commits are being tested it is best to have the slowest jobs first so that as jobs become available they will tackle the slowest
  # tests first.
  include:
    # All unit tests (without coverage)
    - env: PGB_CI="test --vm=u18 --param=c-only --param=no-performance --param=no-coverage"

install:
  - umask 0022 && cd ~ && pwd && whoami && umask && groups
  - df -Th && top -bn1

script:
  - ${TRAVIS_BUILD_DIR?}/test/travis.pl ${PGB_CI?}
